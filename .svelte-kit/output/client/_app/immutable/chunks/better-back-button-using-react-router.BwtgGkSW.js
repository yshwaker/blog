import{s as j,n as g,a as O}from"./scheduler.Bwf3gQP1.js";import{S as z,i as G,d as l,a as n,b as C,s as H,c as m,g as _,e as r,f as T,k as q,h as A,j as y,H as L}from"./index.BB1_hVuL.js";function I(P){let t,k="在做自己的 Side Project 需要每个页面添加类似于 native app 的后退按钮，返回到之前已访问的页面。",B,o,b,h,e,v="因为使用了 <code>react-router</code>，自然的想法是使用<code>history.goBack()</code>。",E,i,M=`<pre class="shiki material-theme-palenight" style="background-color:#292D3E;color:#babed8" tabindex="0"><code><span class="line"><span style="color:#89DDFF;font-style:italic">import</span><span style="color:#89DDFF"> {</span><span style="color:#BABED8"> useHistory</span><span style="color:#89DDFF"> }</span><span style="color:#89DDFF;font-style:italic"> from</span><span style="color:#89DDFF"> '</span><span style="color:#C3E88D">react-router-dom</span><span style="color:#89DDFF">'</span><span style="color:#89DDFF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA">const</span><span style="color:#BABED8"> App </span><span style="color:#89DDFF">=</span><span style="color:#89DDFF"> ()</span><span style="color:#C792EA"> =></span><span style="color:#89DDFF"> {</span></span>
<span class="line"><span style="color:#C792EA">  const</span><span style="color:#BABED8"> history</span><span style="color:#89DDFF"> =</span><span style="color:#82AAFF"> useHistoy</span><span style="color:#F07178">()</span><span style="color:#89DDFF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;font-style:italic">  return</span><span style="color:#F07178"> (</span></span>
<span class="line"><span style="color:#89DDFF">    &#x3C;</span><span style="color:#F07178">button</span><span style="color:#C792EA"> onClick</span><span style="color:#89DDFF">={()</span><span style="color:#C792EA"> =></span><span style="color:#BABED8"> history</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">goBack</span><span style="color:#BABED8">()</span><span style="color:#89DDFF">}</span></span>
<span class="line"><span style="color:#89DDFF">  )</span></span>
<span class="line"><span style="color:#89DDFF">}</span></span></code></pre>`,F,p,w="Easy！但是在浏览器中这样的问题是：如果用户是从别的页面（比如 google.com）通过链接点击或者地址栏输入我们的页面地址的，此时当点击后退按钮，用户会回到 google.com，这显然不是一个 SPA 多期望的。我们希望用户始终处于我们的 web app 中。",f,c,x='<a href="https://stackoverflow.com/questions/34720626/how-to-ensure-that-router-goback-wont-navigate-outside-of-my-app-domain" rel="nofollow">Stackoverflow</a>上的答案并不能解决这一问题，直到我找到这个<a href="https://github.com/ReactTraining/history/issues/582#issuecomment-379271092" rel="nofollow">issue</a>。我们可以通过判断 <code>location</code> 的 <code>key</code> 是否有值来判断当前页面是否是我们 app 的初始页面。',d,D,S=`<pre class="shiki material-theme-palenight" style="background-color:#292D3E;color:#babed8" tabindex="0"><code><span class="line"><span style="color:#89DDFF;font-style:italic">import</span><span style="color:#89DDFF"> {</span><span style="color:#BABED8"> useHistory</span><span style="color:#89DDFF">,</span><span style="color:#BABED8"> useLocation</span><span style="color:#89DDFF"> }</span><span style="color:#89DDFF;font-style:italic"> from</span><span style="color:#89DDFF"> '</span><span style="color:#C3E88D">react-router-dom</span><span style="color:#89DDFF">'</span><span style="color:#89DDFF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA">const</span><span style="color:#BABED8"> App </span><span style="color:#89DDFF">=</span><span style="color:#89DDFF"> ()</span><span style="color:#C792EA"> =></span><span style="color:#89DDFF"> {</span></span>
<span class="line"><span style="color:#C792EA">  const</span><span style="color:#BABED8"> history</span><span style="color:#89DDFF"> =</span><span style="color:#82AAFF"> useHistory</span><span style="color:#F07178">()</span><span style="color:#89DDFF">;</span></span>
<span class="line"><span style="color:#C792EA">  const</span><span style="color:#BABED8"> location</span><span style="color:#89DDFF"> =</span><span style="color:#82AAFF"> useLocation</span><span style="color:#F07178">()</span><span style="color:#89DDFF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic">  // go back to the previous page</span></span>
<span class="line"><span style="color:#676E95;font-style:italic">  // fallback to home page if we are on the initial page</span></span>
<span class="line"><span style="color:#C792EA">  const</span><span style="color:#BABED8"> goBack</span><span style="color:#89DDFF"> =</span><span style="color:#89DDFF"> ()</span><span style="color:#C792EA"> =></span><span style="color:#F07178"> (</span><span style="color:#BABED8">location</span><span style="color:#89DDFF">.</span><span style="color:#BABED8">key</span><span style="color:#89DDFF"> ?</span><span style="color:#BABED8"> history</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">goBack</span><span style="color:#F07178">() </span><span style="color:#89DDFF">:</span><span style="color:#BABED8"> history</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">push</span><span style="color:#F07178">(</span><span style="color:#89DDFF">'</span><span style="color:#C3E88D">/</span><span style="color:#89DDFF">'</span><span style="color:#F07178">))</span><span style="color:#89DDFF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;font-style:italic">  return</span><span style="color:#F07178"> (</span></span>
<span class="line"><span style="color:#89DDFF">    &#x3C;</span><span style="color:#F07178">button</span><span style="color:#C792EA"> onClick</span><span style="color:#89DDFF">={()</span><span style="color:#C792EA"> =></span><span style="color:#BABED8"> history</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">goBack</span><span style="color:#BABED8">()</span><span style="color:#89DDFF">}</span></span>
<span class="line"><span style="color:#89DDFF">  )</span></span>
<span class="line"><span style="color:#89DDFF">}</span></span></code></pre>`,u;return{c(){t=A("p"),t.textContent=k,B=y(),o=A("img"),h=y(),e=A("p"),e.innerHTML=v,E=y(),i=new L(!1),F=y(),p=A("p"),p.textContent=w,f=y(),c=A("p"),c.innerHTML=x,d=y(),D=new L(!1),u=q(),this.h()},l(s){t=m(s,"P",{"data-svelte-h":!0}),_(t)!=="svelte-1sqqos3"&&(t.textContent=k),B=r(s),o=m(s,"IMG",{src:!0,width:!0,height:!0,alt:!0,style:!0}),h=r(s),e=m(s,"P",{"data-svelte-h":!0}),_(e)!=="svelte-h777qg"&&(e.innerHTML=v),E=r(s),i=T(s,!1),F=r(s),p=m(s,"P",{"data-svelte-h":!0}),_(p)!=="svelte-1rzwi99"&&(p.textContent=w),f=r(s),c=m(s,"P",{"data-svelte-h":!0}),_(c)!=="svelte-9bnl1i"&&(c.innerHTML=x),d=r(s),D=T(s,!1),u=q(),this.h()},h(){O(o.src,b="/blog-images/nav.png")||C(o,"src",b),C(o,"width",852/2),C(o,"height",124/2),C(o,"alt","导航栏截图"),H(o,"margin","0 auto"),H(o,"display","block"),i.a=F,D.a=u},m(s,a){n(s,t,a),n(s,B,a),n(s,o,a),n(s,h,a),n(s,e,a),n(s,E,a),i.m(M,s,a),n(s,F,a),n(s,p,a),n(s,f,a),n(s,c,a),n(s,d,a),D.m(S,s,a),n(s,u,a)},p:g,i:g,o:g,d(s){s&&(l(t),l(B),l(o),l(h),l(e),l(E),i.d(),l(F),l(p),l(f),l(c),l(d),l(u),D.d())}}}const R={title:"如何保证同域名下的 router 后退操作",date:"2021-06-26",summary:"如何使用`history.goBack()`并保持页面在相同域名下",updatedOn:"2025-08-16T15:41:37.972Z"},{title:K,date:N,summary:Q,updatedOn:U}=R;class V extends z{constructor(t){super(),G(this,t,null,I,j,{})}}export{V as default,R as metadata};
